<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.*?>

<StackPane xmlns:fx="http://javafx.com/fxml"
           fx:controller="controller.ForgotPasswordController"
           prefWidth="600" prefHeight="700"
           stylesheets="@../css/forgot_password.css"
           style="-fx-background-color: linear-gradient(to bottom right, #0A0E27, #1A1F3A, #252A48, #1A1F3A, #0A0E27);">

    <!-- Animated Background Circles -->
    <StackPane styleClass="background-layer">
        <Circle radius="150" styleClass="bg-circle-1" StackPane.alignment="TOP_LEFT" 
                translateX="-50" translateY="-50"/>
        <Circle radius="200" styleClass="bg-circle-2" StackPane.alignment="BOTTOM_RIGHT" 
                translateX="80" translateY="80"/>
        <Circle radius="120" styleClass="bg-circle-3" StackPane.alignment="CENTER" 
                translateX="-180" translateY="100"/>
    </StackPane>

    <!-- Noise Texture Overlay -->
    <Region styleClass="noise-overlay" StackPane.alignment="CENTER"/>

    <!-- Grid Pattern Overlay -->
    <Region styleClass="grid-pattern" StackPane.alignment="CENTER"/>

    <!-- Main Content Container -->
    <VBox alignment="CENTER" spacing="0" StackPane.alignment="CENTER">
        
        <!-- Main Card with Glass Effect -->
        <VBox fx:id="forgotCard" prefWidth="480" maxWidth="480" spacing="0"
              styleClass="forgot-card">
            
            <!-- Card Header with Gradient -->
            <VBox styleClass="card-header" spacing="16" alignment="CENTER">
                <padding>
                    <Insets top="40" right="40" bottom="30" left="40"/>
                </padding>
                
                <!-- Animated Icon Container -->
                <StackPane styleClass="icon-wrapper">
                    <StackPane styleClass="icon-bg-pulse"/>
                    <StackPane styleClass="icon-container">
                        <Label text="ðŸ”" styleClass="icon-emoji"/>
                    </StackPane>
                </StackPane>
                
                <!-- Title Section -->
                <VBox alignment="CENTER" spacing="10">
                    <Label text="RÃ©cupÃ©ration de Compte" styleClass="main-title">
                        <font>
                            <Font name="System Bold" size="26"/>
                        </font>
                    </Label>
                    
                    <HBox alignment="CENTER" spacing="8">
                        <Region styleClass="title-decoration-left"/>
                        <Label text="âš¡" styleClass="title-icon"/>
                        <Label text="RÃ©initialisation SÃ©curisÃ©e" styleClass="main-subtitle">
                            <font>
                                <Font size="13"/>
                            </font>
                        </Label>
                        <Label text="âš¡" styleClass="title-icon"/>
                        <Region styleClass="title-decoration-right"/>
                    </HBox>
                </VBox>
            </VBox>

            <!-- Animated Divider -->
            <HBox styleClass="divider-container" alignment="CENTER">
                <padding>
                    <Insets top="5" bottom="5"/>
                </padding>
                <Region styleClass="divider-line" HBox.hgrow="ALWAYS"/>
                <Label text="â—" styleClass="divider-dot"/>
                <Region styleClass="divider-line" HBox.hgrow="ALWAYS"/>
            </HBox>

            <!-- Card Body -->
            <VBox styleClass="card-body" spacing="24">
                <padding>
                    <Insets top="35" right="40" bottom="40" left="40"/>
                </padding>

                <!-- Email Input Section -->
                <VBox spacing="14">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <StackPane styleClass="label-icon-container">
                            <Label text="ðŸ“§" styleClass="label-icon"/>
                        </StackPane>
                        <Label text="Adresse Email" styleClass="field-label">
                            <font>
                                <Font name="System Bold" size="14"/>
                            </font>
                        </Label>
                    </HBox>
                    
                    <!-- Input Field Container -->
                    <StackPane styleClass="input-container">
                        <TextField fx:id="emailField" 
                                  promptText="votre.email@exemple.com" 
                                  styleClass="input-field">
                            <font>
                                <Font size="15"/>
                            </font>
                        </TextField>
                        <Label text="âœ“" styleClass="input-check-icon" visible="false" 
                               StackPane.alignment="CENTER_RIGHT">
                            <StackPane.margin>
                                <Insets right="15"/>
                            </StackPane.margin>
                        </Label>
                    </StackPane>
                    
                    <!-- Info Box -->
                    <HBox styleClass="info-box" spacing="10" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="12" right="14" bottom="12" left="14"/>
                        </padding>
                        <StackPane styleClass="info-icon-bg">
                            <Label text="â„¹ï¸" styleClass="info-icon"/>
                        </StackPane>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label text="Extraction Automatique" styleClass="info-title">
                                <font>
                                    <Font name="System Bold" size="11"/>
                                </font>
                            </Label>
                            <Label text="Votre identifiant sera automatiquement extrait de l'adresse email fournie"
                                   styleClass="info-text" wrapText="true">
                                <font>
                                    <Font size="10"/>
                                </font>
                            </Label>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Progress Section -->
                <VBox alignment="CENTER" spacing="12">
                    <StackPane>
                        <StackPane styleClass="progress-bg">
                            <ProgressIndicator fx:id="progressIndicator" 
                                             prefWidth="45" prefHeight="45"
                                             styleClass="progress-indicator" visible="false"/>
                        </StackPane>
                    </StackPane>
                    <Label text="Traitement en cours..." styleClass="progress-text" 
                           visible="false" fx:id="progressText">
                        <font>
                            <Font size="12"/>
                        </font>
                    </Label>
                </VBox>

                <!-- Action Button -->
                <VBox spacing="14">
                    <Button fx:id="resetButton" 
                            text="ðŸš€ RÃ©initialiser le Mot de Passe" 
                            onAction="#onReset"
                            maxWidth="Infinity" 
                            styleClass="reset-button">
                        <font>
                            <Font name="System Bold" size="15"/>
                        </font>
                    </Button>
                    
                    <!-- Security Badge -->
                    <HBox alignment="CENTER" spacing="6">
                        <Label text="ðŸ”’" styleClass="security-icon"/>
                        <Label text="Chiffrement SSL/TLS 256-bit" styleClass="security-text">
                            <font>
                                <Font size="10"/>
                            </font>
                        </Label>
                    </HBox>
                </VBox>

                <!-- Message Display -->
                <StackPane>
                    <VBox fx:id="messageContainer" styleClass="message-container" 
                          spacing="0" visible="false">
                        <padding>
                            <Insets top="14" right="16" bottom="14" left="16"/>
                        </padding>
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <Label fx:id="messageIcon" text="" styleClass="message-icon">
                                <font>
                                    <Font size="18"/>
                                </font>
                            </Label>
                            <Label fx:id="messageLabel" 
                                   text="" 
                                   wrapText="true"
                                   styleClass="message-label"
                                   HBox.hgrow="ALWAYS">
                                <font>
                                    <Font size="13"/>
                                </font>
                            </Label>
                        </HBox>
                    </VBox>
                </StackPane>

                <!-- Password Display Section -->
                <VBox fx:id="passwordContainer" spacing="16" visible="false" styleClass="password-container">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>
                    
                    <!-- Password Header -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <StackPane styleClass="password-icon-bg">
                            <Label text="ðŸ”‘" styleClass="password-icon"/>
                        </StackPane>
                        <VBox spacing="2">
                            <Label text="Nouveau Mot de Passe" styleClass="password-title">
                                <font>
                                    <Font name="System Bold" size="14"/>
                                </font>
                            </Label>
                            <Label text="GÃ©nÃ©rÃ© avec un algorithme cryptographique sÃ©curisÃ©" 
                                   styleClass="password-subtitle">
                                <font>
                                    <Font size="10"/>
                                </font>
                            </Label>
                        </VBox>
                    </HBox>
                    
                    <!-- Password Display Box -->
                    <VBox styleClass="password-display-box" spacing="12">
                        <padding>
                            <Insets top="16" right="16" bottom="16" left="16"/>
                        </padding>
                        
                        <HBox spacing="12" alignment="CENTER">
                            <StackPane styleClass="password-text-container" HBox.hgrow="ALWAYS">
                                <Label fx:id="newPasswordLabel" 
                                       text="" 
                                       styleClass="password-text">
                                    <font>
                                        <Font name="Consolas, Monaco, monospace" size="17"/>
                                    </font>
                                </Label>
                            </StackPane>
                            
                            <VBox spacing="8">
                                <Button fx:id="copyButton" 
                                        onAction="#onCopyPassword"
                                        styleClass="copy-button"
                                        maxWidth="Infinity">
                                    <graphic>
                                        <VBox alignment="CENTER" spacing="2">
                                            <Label text="ðŸ“‹" styleClass="copy-icon">
                                                <font>
                                                    <Font size="18"/>
                                                </font>
                                            </Label>
                                            <Label text="Copier" styleClass="copy-text">
                                                <font>
                                                    <Font size="9"/>
                                                </font>
                                            </Label>
                                        </VBox>
                                    </graphic>
                                </Button>
                            </VBox>
                        </HBox>
                        
                        <!-- Password Strength Indicator -->
                        <HBox spacing="8" alignment="CENTER_LEFT">
                            <Label text="SÃ©curitÃ©:" styleClass="strength-label-text">
                                <font>
                                    <Font size="11"/>
                                </font>
                            </Label>
                            <HBox spacing="4" styleClass="strength-bars">
                                <Region styleClass="strength-bar strength-bar-active"/>
                                <Region styleClass="strength-bar strength-bar-active"/>
                                <Region styleClass="strength-bar strength-bar-active"/>
                                <Region styleClass="strength-bar strength-bar-active"/>
                                <Region styleClass="strength-bar strength-bar-active"/>
                            </HBox>
                            <Label fx:id="strengthLabel" 
                                   text="TrÃ¨s Forte ðŸ›¡ï¸" 
                                   styleClass="strength-label">
                                <font>
                                    <Font name="System Bold" size="11"/>
                                </font>
                            </Label>
                        </HBox>
                    </VBox>
                    
                    <!-- Warning Box -->
                    <HBox styleClass="warning-box" spacing="12" alignment="CENTER_LEFT">
                        <padding>
                            <Insets top="14" right="16" bottom="14" left="16"/>
                        </padding>
                        <StackPane styleClass="warning-icon-bg">
                            <Label text="âš ï¸" styleClass="warning-icon"/>
                        </StackPane>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label text="Important" styleClass="warning-title">
                                <font>
                                    <Font name="System Bold" size="11"/>
                                </font>
                            </Label>
                            <Label text="Copiez ce mot de passe immÃ©diatement. Il ne sera plus accessible aprÃ¨s la fermeture de cette fenÃªtre."
                                   styleClass="warning-text" wrapText="true">
                                <font>
                                    <Font size="10"/>
                                </font>
                            </Label>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Action Buttons -->
                <HBox spacing="14">
                    <Button fx:id="backButton" 
                            onAction="#onBack"
                            styleClass="back-button"
                            HBox.hgrow="ALWAYS">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <Label text="â†" styleClass="button-icon">
                                    <font>
                                        <Font size="16"/>
                                    </font>
                                </Label>
                                <Label text="Retour" styleClass="button-text">
                                    <font>
                                        <Font name="System Bold" size="13"/>
                                    </font>
                                </Label>
                            </HBox>
                        </graphic>
                    </Button>
                    
                    <Button fx:id="closeButton" 
                            onAction="#onClose"
                            styleClass="close-button"
                            visible="false"
                            HBox.hgrow="ALWAYS">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <Label text="TerminÃ©" styleClass="button-text">
                                    <font>
                                        <Font name="System Bold" size="13"/>
                                    </font>
                                </Label>
                                <Label text="âœ“" styleClass="button-icon">
                                    <font>
                                        <Font size="16"/>
                                    </font>
                                </Label>
                            </HBox>
                        </graphic>
                    </Button>
                </HBox>

            </VBox>

            <!-- Card Footer -->
            <VBox styleClass="card-footer" alignment="CENTER" spacing="12">
                <padding>
                    <Insets top="25" right="40" bottom="30" left="40"/>
                </padding>
                
                <Separator styleClass="footer-separator" maxWidth="200"/>
                
                <VBox alignment="CENTER" spacing="8">
                    <HBox alignment="CENTER" spacing="8">
                        <Label text="ðŸ”" styleClass="footer-icon"/>
                        <Label text="Protection Multi-Couches" styleClass="footer-badge">
                            <font>
                                <Font name="System Bold" size="11"/>
                            </font>
                        </Label>
                    </HBox>
                    
                    <HBox alignment="CENTER" spacing="16">
                        <Label text="SSL" styleClass="tech-badge">
                            <font>
                                <Font size="9"/>
                            </font>
                        </Label>
                        <Label text="â€¢" styleClass="separator-dot"/>
                        <Label text="AES-256" styleClass="tech-badge">
                            <font>
                                <Font size="9"/>
                            </font>
                        </Label>
                        <Label text="â€¢" styleClass="separator-dot"/>
                        <Label text="SHA-256" styleClass="tech-badge">
                            <font>
                                <Font size="9"/>
                            </font>
                        </Label>
                    </HBox>
                </VBox>
            </VBox>

        </VBox>

    </VBox>

</StackPane>